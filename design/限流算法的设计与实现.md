## 限流算法的设计与实现

### 固定窗口限流算法

在单位时间内，如果请求的数量到达阈值则进行限流，给定一个时间窗口，在该时间窗口内维护一个计数器：

1. 当计数器的值小于限流阈值时，允许访问，计数器加1
2. 当计数器的值大于等于限流阈值时，拒绝访问
3. 当前的时间窗口过去之后，需要将计数器清零

实现：可以使用redis的string类型进行实现

缺点：无法对两个时间窗口中间的流量进行精确限流，比如定义限流的时间单位为1s，限流的阈值为10次，有两个时间窗口0-1s和1-2s，当0.8-1s内有10次请求，1-1.2s内也有10次请求时，在0-1s和1-2s两个时间窗口内都不会进行限流，允许访问，但是在0.8-1.2这个时间段，不足1s的时间内确有20次访问，远大于10次的限流阈值

### 滑动窗口限流算法

为了解决固定窗口限流算法的缺陷，滑动窗口限流算法将固定窗口限流算法中的单位时间划分为n个小周期，分别记录每个小周期内接口的访问次数，并根据时间滑动，删除过期的小周期，在时间窗口内多个小周期的访问次数综合即为当前时间窗口的访问次数，时间窗口划分的周期越多，则限流越精确。

实现：使用redis到zset数据结构实现

缺点：无法应对短时间内的，一单到达限流后，剩下的请求会被直接拒绝。

### 漏桶限流算法



### 令牌桶限流算法



### 参考文章

* [限流的基本原理及算法实现](https://blog.csdn.net/qq_43638685/article/details/121653457)

* [lightweight-rate-limiter](https://github.com/Redick01/lightweight-rate-limiter)
